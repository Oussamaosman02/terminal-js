<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>JS Terminal</title>
    <meta name="author" content="Jakub Jankiewicz - jcubic&#64;onet.pl" />
    <meta
      name="Description"
      content="Demonstration for JQuery Terminal Emulator using call automaticly JSON-RPC service (in php) with authentication."
    />
    <link rel="shortcut icon" href="favicon.ico" />
    <script src="https://code.jquery.com/jquery-1.7.2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/combine/npm/jquery,npm/jquery.terminal/js/jquery.terminal.min.js,npm/jquery.terminal/js/xml_formatting.js,npm/js-polyfills/keyboard.js,npm/prismjs/prism.min.js,npm/jquery.terminal/js/prism.js,npm/jquery.splitter/js/jquery.splitter.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/combine/npm/terminal-prism/css/prism-coy.css,npm/jquery.terminal/css/jquery.terminal.min.css,npm/jquery.splitter/css/jquery.splitter.css"
      rel="stylesheet"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body>
    <script>
      const help =
        "Esta es la ayuda es guiada\nAparte, este es un salto de linea";
      const ls = "Messi.txt\nAlgo.md";
      const cd_messi_txt = "messi es el mejor";
      // ref: https://stackoverflow.com/q/67322922/387194
      let __EVAL = (s) => eval(`void (__EVAL = ${__EVAL}); ${s}`);
      function repr(object) {
        if (object) {
          if (object instanceof $.fn.init) {
            return "#&lt;jQuery&gt;";
          } else if (typeof object === "object") {
            const name = object.constructor.name;
            if (name) {
              return `#&lt;${name}&gt;`;
            } else {
              return object.toString();
            }
          } else {
            return new String(object);
          }
        } else if (object === null) {
          return "null";
        }
      }
      function repl(fn) {
        return function (code) {
          if (code !== "") {
            try {
              const result = fn(code);
              if (result) {
                this.echo(repr(result));
              }
            } catch (e) {
              this.error(new String(e));
            }
          }
        };
      }
      const term = $("body").terminal(
        repl((code) => __EVAL(code)),
        {
          greetings:
            'JavaScript Console using <a href="https://terminal.jcubic.pl/">jQuery Terminal</a>\n',
          prompt: "javascript> ",
        }
      );
      $.terminal.syntax("javascript");
    </script>
  </body>
</html>
